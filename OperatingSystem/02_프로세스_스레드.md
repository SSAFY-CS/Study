# 프로세스와 스레드, 멀티프로세스와 멀티스레드

## 1. 프로그램과 프로세스란?

-프로그램 : 어떤 작업을 실행할 수 있는 파일(하드에 저장되어있는 정적인 상태의 실행파일)

-프로세스 : 실행 중인 프로그램(프로그램을 메모리에 올려 실행시킨 동적인 상태)

![Untitled](https://user-images.githubusercontent.com/65318329/185769339-f4a022e7-2a3b-4424-a808-1b5096203121.png)

### 프로세스의 특징

-프로세스가 메모리에 올라갈 때 운영체제로부터 시스템 자원을 할당 받는다.

-각각 독립적인 메모리 영역(Code, Data, Stack, Heap)을 할당받는다.

-하나의 프로세스는 다른 프로세스의 변수나 자료구조에 접근할 수 없다.

-다른 프로세스의 자원에 접근하려면 프로세스 간의 통신(IPC, inter-process communication)을 사용해야 한다.

-프로세스 당 최소 1개의 스레드(Main 스레드)를 가지고 있다.

### OS로 부터 할당받는 시스템 자원의 종류

1. Code : 코드 자체를 구성하는 메모리 영역
2. Data : 전역변수(global), 정적변수(static), 배열(array), 구조체(structure) 등이 저장되는 영역으로, 프로그램이 실행 시 생성, 프로그램이 종료 시 반환
3. Stack : 지역(local) 변수, 매개변수(parameter), 리턴 값 등 잠시 사용되었다가 사라지는 데이터를 저장하는 영역으로, 함수 호출 시 생성, 함수 종료 시 반환
4. Heap : 프로그래머가 동적으로 사용하는 영역

### 프로세스의 단점

-각각 독립된 메모리 영역(code, data, stack, heap의 구조)을 할당받는다. → 하나의 프로세스는 다른 프로세스의 변수나 자료구조에 접근할 수 없다.

-단점 : 각각 독립 메모리 영역을 가지기에 context switching에 많은 오버헤드가 발생한다.

context switching : 하나의 프로세스를 실행하고 있는 상태에서 다음 프로세스가 실행되어야 할 때 기존의 프로세스의 상태 또는 레지스터 값(context)을 저장하고 cpu가 다음 프로세스를 수행하도록 새로운 프로세스의 상태 또는 레지스터 값을 교체하는 작업

![image](https://user-images.githubusercontent.com/65318329/185769353-ecd38970-86d1-4bba-a032-d66995393f9c.png)


## 2. 프로세스 vs 스레드

프로세스 : (하드디스크에 있는) 프로그램을 메인 메모리에 올려 동적으로 실행시킨 상태로, OS 입장에서의 최소 작업 단위

스레드 : 프로그램의 단위가 커지고 복잡해짐에 따라 프로세스보다 더 작은 실행 단위로, CPU 입장에서의 최소 작업 단위

### 스레드의 특징 및 장단점

-특징

같은 프로세스의 스레드들끼리는 각각 stack만 따로 할당받고, 프로세스 내의 주소 공간이나 자원들(code/data/heap)은 공유한다.

-장점

1. 스레드간 데이터를 주고 받는 때 자원 소모가 줄고, 응답 시간이 단축된다.
2. Context Switching의 오버헤드가 해결된다.

-단점

1. 서로 데이터를 사용하다가 충돌이 일어날 수 있다.
2. 어떤 스레드 하나에서 오류가 발생한다면 같은 프로세스 내의 다른 스레드 모두가 강제로 종료된다.

## 3. 멀티프로세스 vs 멀티스레드

![image](https://user-images.githubusercontent.com/65318329/185769359-1f627c63-7079-4829-97c0-f432fca87823.png)


-멀티 프로세스 : 하나의 운영체제 안에서 여러 프로세스가 동시에 실행되는 것

-멀티 스레드 : 하나의 프로세스 안에서 여러 스레드를 사용하여 동시에 처리하는 것

### 멀티 프로세스 대신의 멀티 스레드를 사용하는 이유?

1. 메모리 측면 : 자원을 효율적으로 사용하기 위해

멀티 프로세스의 경우 프로세스를 생성하여 자원을 할당하는 시스템 콜을 할 때마다 오버헤드가 크지만, 멀티 스레드는 메모리 영역을 공유하기 때문에 시스템 자원을 효율적으로 사용할 수 있다.

1. 속도 측면 : Context-Switching 비용을 줄이고 응답 속도를 빠르게 하기 위해

메모리 영역을 공유하기 때문에 Context-Switching과 스레드 간의 통신 시 Stack 영역만 처리하기에 통신 비용이 적고 응답속도가 빠르다.

### 멀티 스레드의 단점

1. 스레드 하나가 프로세스 내 자원을 망쳐버린다면 모든 프로세스가 종료될 수 있다.
2. 자원을 공유하기 때문에 필연적으로 동기화 문제가 발생할 수 있다.

## 4. 동시성 vs 병렬성

## 동시성

동시에 처리하는 것은 사실 빠르게 Context-Switching하는 것이고, 그 속도가 빠르기에 사용자는 동시에 여러 일을 처리한다고 느낀다. (CPU는 한 번에 하나의 프로세스만 실행이 가능하다.)

## 병렬성

정말 실제로 병렬성을 띄며 동시에 여러 일을 처리하는 것은 CPU의 갯수가 여러개일 때이다. 싱글코어… 듀얼코어 등등
